<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>emloop.models &#8212; emloop 0.2.1 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/highlight.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="emloop.hooks" href="emloop.hooks.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          emloop</a>
        <span class="navbar-text navbar-version pull-left"><b>0.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../getting_started.html">Getting Started</a></li>
                <li><a href="../tutorial.html">Tutorial</a></li>
                <li><a href="../advanced/index.html">Advanced</a></li>
                <li><a href="../cli.html">CLI Reference</a></li>
                <li><a href="index.html">API Reference</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Pages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary">
<div class="side_nav">
    <a href="emloop.hooks.html" title="Previous Chapter: emloop.hooks"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; emloop.hooks</span>
    </a>
    </div><ul>
<li><a class="reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">emloop.models</span></code></a><ul>
<li><a class="reference internal" href="#classes">Classes</a></li>
</ul>
</li>
</ul>

<form action="../search.html" method="get" class="searchbox">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form><div class="side_nav">
	<h4>Related projects</h4>
</div>
<ul class="nav nav-list">
	<li><a href="https://emloop.org">emloop</a></li>
	<li><a href="https://tensorflow.emloop.org">emloop-tensorflow</a></li>
	<li><a href="https://hipipe.org">hipipe (c++)</a></li>
</ul>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="section" id="module-emloop.models">
<span id="emloop-models"></span><h1><code class="docutils literal notranslate"><span class="pre">emloop.models</span></code><a class="headerlink" href="#module-emloop.models" title="Permalink to this headline">¶</a></h1>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#emloop.models.AbstractModel" title="emloop.models.AbstractModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractModel</span></code></a>:
Abstract machine learning model which exposes input and output names, run and save methods.</p></li>
<li><p><a class="reference internal" href="#emloop.models.Ensemble" title="emloop.models.Ensemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ensemble</span></code></a>:
Ensemble model facilitates assembling multiple models into one for more accurate predictions.</p></li>
<li><p><a class="reference internal" href="#emloop.models.Sequence" title="emloop.models.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>:
Model sequence provides simple abstraction for sequential application of multiple models to input batches.</p></li>
</ul>
<dl class="class">
<dt id="emloop.models.AbstractModel">
<em class="property">class </em><code class="descclassname">emloop.models.</code><code class="descname">AbstractModel</code><span class="sig-paren">(</span><em>dataset</em>, <em>log_dir</em>, <em>restore_from=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#emloop.models.AbstractModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract machine learning model which exposes input and output names, run and save methods.
<cite>AbstractModel</cite> implementations are trainable with <a class="reference internal" href="emloop.html#emloop.MainLoop" title="emloop.MainLoop"><code class="xref py py-class docutils literal notranslate"><span class="pre">emloop.MainLoop</span></code></a>.</p>
<div class="graphviz"><img src="../_images/inheritance-f4ac830770dbea7306599e841daa43ca679323f9.png" alt="Inheritance diagram of AbstractModel" class="inheritance graphviz" /></div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="method">
<dt id="emloop.models.AbstractModel.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>dataset</em>, <em>log_dir</em>, <em>restore_from=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/models/abstract_model.html#AbstractModel.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.models.AbstractModel.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Model constructor interface.</p>
<p>Additional parameters (currently covered by <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>) are passed
according to the configuration <code class="docutils literal notranslate"><span class="pre">model</span></code> section.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="emloop.datasets.html#emloop.datasets.AbstractDataset" title="emloop.datasets.AbstractDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractDataset</span></code></a>]) – dataset object</p></li>
<li><p><strong>log_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – existing directory in which all output files should be stored</p></li>
<li><p><strong>restore_from</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – information passed to the model constructor (backend-specific);
usually a directory in which the trained model is stored</p></li>
<li><p><strong>kwargs</strong> – configuration section <code class="docutils literal notranslate"><span class="pre">model</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="emloop.models.AbstractModel.input_names">
<code class="descname">input_names</code><a class="headerlink" href="#emloop.models.AbstractModel.input_names" title="Permalink to this definition">¶</a></dt>
<dd><p>List of model input names.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="emloop.models.AbstractModel.output_names">
<code class="descname">output_names</code><a class="headerlink" href="#emloop.models.AbstractModel.output_names" title="Permalink to this definition">¶</a></dt>
<dd><p>List of model output names.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="emloop.models.AbstractModel.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>batch</em>, <em>train</em>, <em>stream</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/models/abstract_model.html#AbstractModel.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.models.AbstractModel.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run feed-forward pass with the given batch and return the results as dict.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">train=True</span></code>, also update parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]) – batch to be processed</p></li>
<li><p><strong>train</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">True</span></code> if this batch should be used for model update, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise</p></li>
<li><p><strong>stream</strong> (<a class="reference internal" href="emloop.datasets.html#emloop.datasets.StreamWrapper" title="emloop.datasets.StreamWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamWrapper</span></code></a>) – stream wrapper (useful for precise buffer management)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>results dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="emloop.models.AbstractModel.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>name_suffix</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/models/abstract_model.html#AbstractModel.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.models.AbstractModel.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model parameters with the given <code class="docutils literal notranslate"><span class="pre">name_suffix</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name_suffix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – name suffix to be appended to the saved model</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>path to the saved file/dir</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.models.Ensemble">
<em class="property">class </em><code class="descclassname">emloop.models.</code><code class="descname">Ensemble</code><span class="sig-paren">(</span><em>inputs</em>, <em>outputs</em>, <em>aggregation='major_vote'</em>, <em>models_root=None</em>, <em>model_paths=None</em>, <em>dataset=None</em>, <em>eager_loading=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/models/ensemble.html#Ensemble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.models.Ensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#emloop.models.AbstractModel" title="emloop.models.AbstractModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.AbstractModel</span></code></a></p>
<p>Ensemble model facilitates assembling multiple models into one for more accurate predictions.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Ensemble model can be used for inference only (i.e. no training is supported).</p>
</div>
<p>The typical usage is to train multiple (possibly different) models and assemble them with this class.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">usage from config</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">model</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MyEnsemble</span>
  <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">emloop.models.Ensemble</span>

  <span class="nt">inputs</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">images</span><span class="p p-Indicator">]</span>
  <span class="nt">outputs</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">predictions</span><span class="p p-Indicator">]</span>

  <span class="nt">models_root</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/var/project/models</span>  <span class="c1"># will load all the models under this directory</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">usage from python</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">emloop</span> <span class="kn">as</span> <span class="nn">el</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Ensemble</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;images&#39;</span><span class="p">],</span> <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">],</span> <span class="n">aggregation</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>
                           <span class="n">models_root</span><span class="o">=</span><span class="s1">&#39;/my/directory/with/models&#39;</span><span class="p">)</span>
<span class="c1"># model.run(...)</span>
</pre></div>
</div>
</div>
<div class="graphviz"><img src="../_images/inheritance-bc6796fd7992bbebf9afe6c02eb6693c63d308f1.png" alt="Inheritance diagram of Ensemble" class="inheritance graphviz" /></div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="attribute">
<dt id="emloop.models.Ensemble.AGGREGATION_METHODS">
<code class="descname">AGGREGATION_METHODS</code><em class="property"> = ['mean', 'major_vote']</em><a class="headerlink" href="#emloop.models.Ensemble.AGGREGATION_METHODS" title="Permalink to this definition">¶</a></dt>
<dd><p>Possible ensemble aggregation methods.</p>
</dd></dl>

<dl class="method">
<dt id="emloop.models.Ensemble.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>inputs</em>, <em>outputs</em>, <em>aggregation='major_vote'</em>, <em>models_root=None</em>, <em>model_paths=None</em>, <em>dataset=None</em>, <em>eager_loading=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/models/ensemble.html#Ensemble.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.models.Ensemble.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new Ensemble.</p>
<p>If no <code class="docutils literal notranslate"><span class="pre">models_paths</span></code> are specified, all the sub-directories of the <code class="docutils literal notranslate"><span class="pre">models_root</span></code> will be taken as the models
to be assembled together.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – model input names</p></li>
<li><p><strong>outputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – model output names</p></li>
<li><p><strong>aggregation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – aggregation method, one of <a class="reference internal" href="#emloop.models.Ensemble.AGGREGATION_METHODS" title="emloop.models.Ensemble.AGGREGATION_METHODS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Ensemble.AGGREGATION_METHODS</span></code></a></p></li>
<li><p><strong>models_root</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – optional root directory of the models to be assembled together</p></li>
<li><p><strong>model_paths</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]) – optional list of model directory names/paths</p></li>
<li><p><strong>dataset</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="emloop.datasets.html#emloop.datasets.AbstractDataset" title="emloop.datasets.AbstractDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractDataset</span></code></a>]) – optional <strong>emloop</strong> dataset (will be passed to the assembled models)</p></li>
<li><p><strong>eager_loading</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – load all the models in the constructor</p></li>
<li><p><strong>kwargs</strong> – additional kwargs (unused)</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.7)"><strong>AssertionError</strong></a> – if neither one of <code class="docutils literal notranslate"><span class="pre">models_root</span></code> and <code class="docutils literal notranslate"><span class="pre">model_paths</span></code> is specified</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.7)"><strong>AssertionError</strong></a> – if the specified <code class="docutils literal notranslate"><span class="pre">aggregation</span></code> is not one of <a class="reference internal" href="#emloop.models.Ensemble.AGGREGATION_METHODS" title="emloop.models.Ensemble.AGGREGATION_METHODS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Ensemble.AGGREGATION_METHODS</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="emloop.models.Ensemble._load_models">
<code class="descname">_load_models</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/models/ensemble.html#Ensemble._load_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.models.Ensemble._load_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Maybe load all the models to be assembled together and save them to the <code class="docutils literal notranslate"><span class="pre">self._models</span></code> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="emloop.models.Ensemble.input_names">
<code class="descname">input_names</code><a class="headerlink" href="#emloop.models.Ensemble.input_names" title="Permalink to this definition">¶</a></dt>
<dd><p>List of model input names.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="emloop.models.Ensemble.output_names">
<code class="descname">output_names</code><a class="headerlink" href="#emloop.models.Ensemble.output_names" title="Permalink to this definition">¶</a></dt>
<dd><p>List of model output names.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="emloop.models.Ensemble.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>batch</em>, <em>train=False</em>, <em>stream=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/models/ensemble.html#Ensemble.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.models.Ensemble.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run feed-forward pass with the given batch using all the models, aggregate and return the results.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><a class="reference internal" href="#emloop.models.Ensemble" title="emloop.models.Ensemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ensemble</span></code></a> can not be trained.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]) – batch to be processed</p></li>
<li><p><strong>train</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">True</span></code> if this batch should be used for model update, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise</p></li>
<li><p><strong>stream</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="emloop.datasets.html#emloop.datasets.StreamWrapper" title="emloop.datasets.StreamWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamWrapper</span></code></a>]) – stream wrapper (useful for precise buffer management)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>aggregated results dict</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.7)"><strong>ValueError</strong></a> – if the <code class="docutils literal notranslate"><span class="pre">train</span></code> flag is set to <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="emloop.models.Ensemble.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/models/ensemble.html#Ensemble.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.models.Ensemble.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensemble model can not be saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.7)"><strong>NotImplementedError</strong></a> – when called</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.models.Sequence">
<em class="property">class </em><code class="descclassname">emloop.models.</code><code class="descname">Sequence</code><span class="sig-paren">(</span><em>model_paths</em>, <em>models_root=None</em>, <em>dataset=None</em>, <em>eager_loading=False</em>, <em>**_</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/models/sequence.html#Sequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.models.Sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#emloop.models.AbstractModel" title="emloop.models.AbstractModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.AbstractModel</span></code></a></p>
<p>Model sequence provides simple abstraction for sequential application of multiple models to input batches.
All the models are fed with the original inputs as well as the outputs of the preceding models.
Ultimately, all the model outputs are returned.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Model sequence can be used for inference only (i.e. no training is supported).</p>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">usage from config</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">model</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MyPipeline</span>
  <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">emloop.models.Sequence</span>

  <span class="nt">models_root</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/var/project/models</span>
  <span class="nt">model_paths</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">step1</span><span class="p p-Indicator">,</span> <span class="nv">step2</span><span class="p p-Indicator">,</span> <span class="nv">step3</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">usage from python</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">emloop</span> <span class="kn">as</span> <span class="nn">el</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequence</span><span class="p">(</span><span class="n">model_paths</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;/path/to/step/step1&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/step/step2&#39;</span><span class="p">])</span>
<span class="c1"># model.run(...)</span>
</pre></div>
</div>
</div>
<div class="graphviz"><img src="../_images/inheritance-92787517849bb51d82928c8d67218fc55ee0b37d.png" alt="Inheritance diagram of Sequence" class="inheritance graphviz" /></div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="method">
<dt id="emloop.models.Sequence.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>model_paths</em>, <em>models_root=None</em>, <em>dataset=None</em>, <em>eager_loading=False</em>, <em>**_</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/models/sequence.html#Sequence.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.models.Sequence.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new model <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>models_root</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – optional root directory of the models to be assembled together</p></li>
<li><p><strong>model_paths</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – list of model directory names/paths</p></li>
<li><p><strong>dataset</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="emloop.datasets.html#emloop.datasets.AbstractDataset" title="emloop.datasets.AbstractDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractDataset</span></code></a>]) – optional <strong>emloop</strong> dataset (will be passed to the underlying models)</p></li>
<li><p><strong>eager_loading</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – load all the models in the constructor</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="emloop.models.Sequence._load_models">
<code class="descname">_load_models</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/models/sequence.html#Sequence._load_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.models.Sequence._load_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Maybe load all the models to be applied and save them to the <code class="docutils literal notranslate"><span class="pre">self._models</span></code> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="emloop.models.Sequence.input_names">
<code class="descname">input_names</code><a class="headerlink" href="#emloop.models.Sequence.input_names" title="Permalink to this definition">¶</a></dt>
<dd><p>List of model input names.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="emloop.models.Sequence.output_names">
<code class="descname">output_names</code><a class="headerlink" href="#emloop.models.Sequence.output_names" title="Permalink to this definition">¶</a></dt>
<dd><p>List of model output names.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="emloop.models.Sequence.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>batch</em>, <em>train=False</em>, <em>stream=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/models/sequence.html#Sequence.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.models.Sequence.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run all the models in-order and return accumulated outputs.</p>
<p>N-th model is fed with the original inputs and outputs of all the models that were run before it.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><a class="reference internal" href="#emloop.models.Sequence" title="emloop.models.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> model can not be trained.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]) – batch to be processed</p></li>
<li><p><strong>train</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">True</span></code> if this batch should be used for model update, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise</p></li>
<li><p><strong>stream</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="emloop.datasets.html#emloop.datasets.StreamWrapper" title="emloop.datasets.StreamWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamWrapper</span></code></a>]) – stream wrapper (useful for precise buffer management)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>accumulated model outputs</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.7)"><strong>ValueError</strong></a> – if the <code class="docutils literal notranslate"><span class="pre">train</span></code> flag is set to <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="emloop.models.Sequence.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/models/sequence.html#Sequence.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.models.Sequence.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Sequence model can not be saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.7)"><strong>NotImplementedError</strong></a> – when called</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, Iterait a.s..<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.1.<br/>
    </p>
  </div>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-108491604-2"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-108491604-2');
</script>



  </body>
</html>