<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>emloop.hooks &#8212; emloop 0.1.0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/highlight.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="emloop.models" href="emloop.models.html" />
    <link rel="prev" title="emloop.datasets" href="emloop.datasets.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          emloop</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../getting_started.html">Getting Started</a></li>
                <li><a href="../tutorial.html">Tutorial</a></li>
                <li><a href="../advanced/index.html">Advanced</a></li>
                <li><a href="../cli.html">CLI Reference</a></li>
                <li><a href="index.html">API Reference</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Pages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary">
<div class="side_nav">
    <a href="emloop.datasets.html" title="Previous Chapter: emloop.datasets"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; emloop.datasets</span>
    </a>
    </div>
<div class="side_nav">
    <a href="emloop.models.html" title="Next Chapter: emloop.models"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">emloop.models &raquo;</span>
    </a>
    </div><ul>
<li><a class="reference internal" href="#"><code class="docutils literal"><span class="pre">emloop.hooks</span></code></a><ul>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#exceptions">Exceptions</a></li>
</ul>
</li>
</ul>

<form action="../search.html" method="get" class="searchbox">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form><div class="side_nav">
	<h4>Related projects</h4>
</div>
<ul class="nav nav-list">
	<li><a href="https://cxflow.org">cxflow</a></li>
	<li><a href="https://tensorflow.cxflow.org">cxflow-tensorflow</a></li>
	<li><a href="https://hipipe.org">hipipe (c++)</a></li>
</ul>
        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="module-emloop.hooks">
<span id="emloop-hooks"></span><h1><code class="docutils literal"><span class="pre">emloop.hooks</span></code><a class="headerlink" href="#module-emloop.hooks" title="Permalink to this headline">¶</a></h1>
<p>Module with official <strong>emloop</strong> hooks.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Hooks listed here may be configured without specifying their fully qualified names. E.g.:</p>
<div class="last highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SaveBest</span>
</pre></div>
</div>
</div>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="#emloop.hooks.AbstractHook" title="emloop.hooks.AbstractHook"><code class="xref py py-class docutils literal"><span class="pre">AbstractHook</span></code></a>:
<strong>emloop</strong> hook interface.</li>
<li><a class="reference internal" href="#emloop.hooks.AccumulateVariables" title="emloop.hooks.AccumulateVariables"><code class="xref py py-class docutils literal"><span class="pre">AccumulateVariables</span></code></a>:
Accumulate the specified variables allowing their aggregation after each epoch.</li>
<li><a class="reference internal" href="#emloop.hooks.WriteCSV" title="emloop.hooks.WriteCSV"><code class="xref py py-class docutils literal"><span class="pre">WriteCSV</span></code></a>:
Log <code class="docutils literal"><span class="pre">epoch_data</span></code> variables to a CSV file after each epoch.</li>
<li><a class="reference internal" href="#emloop.hooks.StopAfter" title="emloop.hooks.StopAfter"><code class="xref py py-class docutils literal"><span class="pre">StopAfter</span></code></a>:
Stop the training after any of the specified conditions is met.</li>
<li><a class="reference internal" href="#emloop.hooks.LogVariables" title="emloop.hooks.LogVariables"><code class="xref py py-class docutils literal"><span class="pre">LogVariables</span></code></a>:
Log the training results to stderr via standard <a class="reference external" href="https://docs.python.org/3.6/library/logging.html#module-logging" title="(in Python v3.6)"><code class="xref py py-mod docutils literal"><span class="pre">logging</span></code></a> module.</li>
<li><a class="reference internal" href="#emloop.hooks.LogProfile" title="emloop.hooks.LogProfile"><code class="xref py py-class docutils literal"><span class="pre">LogProfile</span></code></a>:
Summarize and log epoch profile via standard <a class="reference external" href="https://docs.python.org/3.6/library/logging.html#module-logging" title="(in Python v3.6)"><code class="xref py py-mod docutils literal"><span class="pre">logging</span></code></a>.</li>
<li><a class="reference internal" href="#emloop.hooks.LogDir" title="emloop.hooks.LogDir"><code class="xref py py-class docutils literal"><span class="pre">LogDir</span></code></a>:
Log the output dir before training, after each epoch and after training.</li>
<li><a class="reference internal" href="#emloop.hooks.SaveEvery" title="emloop.hooks.SaveEvery"><code class="xref py py-class docutils literal"><span class="pre">SaveEvery</span></code></a>:
Save the model every <code class="docutils literal"><span class="pre">n_epochs</span></code> epoch.</li>
<li><a class="reference internal" href="#emloop.hooks.SaveBest" title="emloop.hooks.SaveBest"><code class="xref py py-class docutils literal"><span class="pre">SaveBest</span></code></a>:
Maintain the best performing model given the specified criteria.</li>
<li><a class="reference internal" href="#emloop.hooks.SaveLatest" title="emloop.hooks.SaveLatest"><code class="xref py py-class docutils literal"><span class="pre">SaveLatest</span></code></a>:
Save the latest model.</li>
<li><a class="reference internal" href="#emloop.hooks.ComputeStats" title="emloop.hooks.ComputeStats"><code class="xref py py-class docutils literal"><span class="pre">ComputeStats</span></code></a>:
Accumulate the specified variables, compute the specified aggregation values and save them to the epoch data.</li>
<li><a class="reference internal" href="#emloop.hooks.Check" title="emloop.hooks.Check"><code class="xref py py-class docutils literal"><span class="pre">Check</span></code></a>:
Terminate training if the given stream variable exceeds the threshold in at most specified number of epochs.</li>
<li><a class="reference internal" href="#emloop.hooks.ShowProgress" title="emloop.hooks.ShowProgress"><code class="xref py py-class docutils literal"><span class="pre">ShowProgress</span></code></a>:
Show stream progresses and ETA in the current epoch.</li>
<li><a class="reference internal" href="#emloop.hooks.EveryNEpoch" title="emloop.hooks.EveryNEpoch"><code class="xref py py-class docutils literal"><span class="pre">EveryNEpoch</span></code></a>:
This hook should be used as base hook in the case when some action need to be processed every n epoch.</li>
<li><a class="reference internal" href="#emloop.hooks.OnPlateau" title="emloop.hooks.OnPlateau"><code class="xref py py-class docutils literal"><span class="pre">OnPlateau</span></code></a>:
Base hook for hooks taking actions when certain variable reaches its plateau.</li>
<li><a class="reference internal" href="#emloop.hooks.StopOnPlateau" title="emloop.hooks.StopOnPlateau"><code class="xref py py-class docutils literal"><span class="pre">StopOnPlateau</span></code></a>:
Terminate the training when the observed variable reaches its plateau.</li>
<li><a class="reference internal" href="#emloop.hooks.StopOnNaN" title="emloop.hooks.StopOnNaN"><code class="xref py py-class docutils literal"><span class="pre">StopOnNaN</span></code></a>:
Stop the training when any of the specified variables contain NaN.</li>
<li><a class="reference internal" href="#emloop.hooks.SaveConfusionMatrix" title="emloop.hooks.SaveConfusionMatrix"><code class="xref py py-class docutils literal"><span class="pre">SaveConfusionMatrix</span></code></a>:
After each epoch, compute and save/store confusion matrix figure for the predicted and expected labels.</li>
</ul>
<dl class="class">
<dt id="emloop.hooks.AbstractHook">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">AbstractHook</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#emloop.hooks.AbstractHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p><strong>emloop</strong> hook interface.</p>
<p>Hook lifecycle (event -&gt; method invocation):</p>
<ol class="arabic simple">
<li><strong>emloop</strong> constructs the hooks -&gt; <a class="reference internal" href="#emloop.hooks.AbstractHook.__init__" title="emloop.hooks.AbstractHook.__init__"><code class="xref py py-meth docutils literal"><span class="pre">__init__()</span></code></a></li>
<li><dl class="first docutils">
<dt><strong>emloop</strong> enters the main loop -&gt; <a class="reference internal" href="#emloop.hooks.AbstractHook.before_training" title="emloop.hooks.AbstractHook.before_training"><code class="xref py py-meth docutils literal"><span class="pre">before_training()</span></code></a></dt>
<dd><ol class="first last loweralpha">
<li><strong>emloop</strong> starts an epoch</li>
<li><strong>emloop</strong> computes a batch -&gt; <a class="reference internal" href="#emloop.hooks.AbstractHook.after_batch" title="emloop.hooks.AbstractHook.after_batch"><code class="xref py py-meth docutils literal"><span class="pre">after_batch()</span></code></a></li>
<li><strong>emloop</strong> finishes the epoch -&gt; <a class="reference internal" href="#emloop.hooks.AbstractHook.after_epoch" title="emloop.hooks.AbstractHook.after_epoch"><code class="xref py py-meth docutils literal"><span class="pre">after_epoch()</span></code></a> and <a class="reference internal" href="#emloop.hooks.AbstractHook.after_epoch_profile" title="emloop.hooks.AbstractHook.after_epoch_profile"><code class="xref py py-meth docutils literal"><span class="pre">after_epoch_profile()</span></code></a></li>
</ol>
</dd>
</dl>
</li>
<li><strong>emloop</strong> terminates the main loop -&gt; <a class="reference internal" href="#emloop.hooks.AbstractHook.after_training" title="emloop.hooks.AbstractHook.after_training"><code class="xref py py-meth docutils literal"><span class="pre">after_training()</span></code></a></li>
</ol>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p>Hook naming conventions:</p>
<ul class="last simple">
<li>hook names should describe hook actions with verb stems. E.g.: <code class="docutils literal"><span class="pre">LogProfile</span></code> or <code class="docutils literal"><span class="pre">SaveBest</span></code></li>
<li>hook names should not include <code class="docutils literal"><span class="pre">Hook</span></code> suffix</li>
</ul>
</div>
<img src="../_images/inheritance-ad6297b61e20ae8fc85a4800f6b55144829b8c6e.png" alt="Inheritance diagram of AbstractHook" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="method">
<dt id="emloop.hooks.AbstractHook.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/abstract_hook.html#AbstractHook.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.AbstractHook.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Check and warn if there is any argument created by the user yet not recognized in the child hook <code class="docutils literal"><span class="pre">__init__</span></code>
method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kwargs</strong> – <code class="docutils literal"><span class="pre">**kwargs</span></code> not recognized in the child hook</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.AbstractHook.after_batch">
<code class="descname">after_batch</code><span class="sig-paren">(</span><em>stream_name</em>, <em>batch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/abstract_hook.html#AbstractHook.after_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.AbstractHook.after_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>After batch event.</p>
<p>This event is triggered after every processed batch regardless of stream type.
Batch results are available in results argument.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>stream_name</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – name of the stream (usually <code class="docutils literal"><span class="pre">train</span></code>, <code class="docutils literal"><span class="pre">valid</span></code> or``test``)</li>
<li><strong>batch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Sequence" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Any" title="(in Python v3.6)"><code class="xref py py-data docutils literal"><span class="pre">Any</span></code></a>]]) – batch inputs and model outputs</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">None</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.AbstractHook.after_epoch">
<code class="descname">after_epoch</code><span class="sig-paren">(</span><em>epoch_id</em>, <em>epoch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/abstract_hook.html#AbstractHook.after_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.AbstractHook.after_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>After epoch event.</p>
<p>This event is triggered after every epoch wherein all the streams were iterated. The <code class="docutils literal"><span class="pre">epoch_data</span></code> object is
initially empty and shared among all the hooks.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>epoch_id</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>) – finished epoch id</li>
<li><strong>epoch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a>]) – epoch data flowing through all hooks</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">None</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.AbstractHook.after_epoch_profile">
<code class="descname">after_epoch_profile</code><span class="sig-paren">(</span><em>epoch_id</em>, <em>profile</em>, <em>train_stream_name</em>, <em>extra_streams</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/abstract_hook.html#AbstractHook.after_epoch_profile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.AbstractHook.after_epoch_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>After epoch profile event.</p>
<p>This event provides opportunity to process time profile of the finished epoch.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>epoch_id</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>) – finished epoch id</li>
<li><strong>profile</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.List" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">float</span></code></a>]]) – dictionary of lists of event timings that were measured during the epoch</li>
<li><strong>extra_streams</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Iterable" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>]) – enumeration of additional stream names</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">None</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.AbstractHook.after_training">
<code class="descname">after_training</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/abstract_hook.html#AbstractHook.after_training"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.AbstractHook.after_training" title="Permalink to this definition">¶</a></dt>
<dd><p>After training event.</p>
<p>This event is called after the training finished either naturally or thanks to an interrupt.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method is called exactly once during the training.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.AbstractHook.before_training">
<code class="descname">before_training</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/abstract_hook.html#AbstractHook.before_training"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.AbstractHook.before_training" title="Permalink to this definition">¶</a></dt>
<dd><p>Before training event.</p>
<p>No data were processed at this moment.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method is called exactly once during the training.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.AccumulateVariables">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">AccumulateVariables</code><span class="sig-paren">(</span><em>variables</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/accumulate_variables.html#AccumulateVariables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.AccumulateVariables" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#emloop.hooks.AbstractHook" title="emloop.hooks.AbstractHook"><code class="xref py py-class docutils literal"><span class="pre">hooks.AbstractHook</span></code></a></p>
<p>Accumulate the specified variables allowing their aggregation after each epoch.</p>
<p>The hook itself does not utilize the accumulated variables. It is meant to be inherited from. The child hook
will have the accumulated variables available in <code class="docutils literal"><span class="pre">self._accumulator</span></code> after each epoch.</p>
<p>The data are accumulated in a form of nested mapping
<code class="docutils literal"><span class="pre">stream_name</span></code> -&gt; <code class="docutils literal"><span class="pre">variable_name</span></code> -&gt; <code class="docutils literal"><span class="pre">Iterable``[``values</span></code>].</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This hook should not be used directly as it does nothing on its own.</p>
</div>
<img src="../_images/inheritance-703daac1ff3bde2434ecf90fc889a263ffbc3f5d.png" alt="Inheritance diagram of AccumulateVariables" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="method">
<dt id="emloop.hooks.AccumulateVariables.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>variables</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/accumulate_variables.html#AccumulateVariables.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.AccumulateVariables.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new AccumulateVariables hook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>variables</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Iterable" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>]) – collection of variable names to be logged</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.AccumulateVariables._reset_accumulator">
<code class="descname">_reset_accumulator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/accumulate_variables.html#AccumulateVariables._reset_accumulator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.AccumulateVariables._reset_accumulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the accumulator to an empty double-index <a class="reference external" href="https://docs.python.org/3.6/library/collections.html#collections.defaultdict" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">collections.defaultdict</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.AccumulateVariables.after_batch">
<code class="descname">after_batch</code><span class="sig-paren">(</span><em>stream_name</em>, <em>batch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/accumulate_variables.html#AccumulateVariables.after_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.AccumulateVariables.after_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Extend the accumulated variables with the given batch data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>stream_name</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – stream name; e.g. <code class="docutils literal"><span class="pre">train</span></code> or any other…</li>
<li><strong>batch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Sequence" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Any" title="(in Python v3.6)"><code class="xref py py-data docutils literal"><span class="pre">Any</span></code></a>]]) – batch data = stream sources + model outputs</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#KeyError" title="(in Python v3.6)"><strong>KeyError</strong></a> – if the variables to be aggregated are missing</li>
<li><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#TypeError" title="(in Python v3.6)"><strong>TypeError</strong></a> – if the variable value is not iterable (e.g. it is only a scalar)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.AccumulateVariables.after_epoch">
<code class="descname">after_epoch</code><span class="sig-paren">(</span><em>**_</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/accumulate_variables.html#AccumulateVariables.after_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.AccumulateVariables.after_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the accumulator after each epoch.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.WriteCSV">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">WriteCSV</code><span class="sig-paren">(</span><em>output_dir</em>, <em>output_file='training.csv'</em>, <em>delimiter='</em>, <em>'</em>, <em>default_value=''</em>, <em>variables=None</em>, <em>on_unknown_type='default'</em>, <em>on_missing_variable='error'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/write_csv.html#WriteCSV"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.WriteCSV" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#emloop.hooks.AbstractHook" title="emloop.hooks.AbstractHook"><code class="xref py py-class docutils literal"><span class="pre">hooks.AbstractHook</span></code></a></p>
<p>Log <code class="docutils literal"><span class="pre">epoch_data</span></code> variables to a CSV file after each epoch.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Log all the variables</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">WriteCSV</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Log only certain variables</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">WriteCSV</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">variables</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">loss</span><span class="p p-Indicator">,</span> <span class="nv">fscore</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Warn about unsupported variables</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">WriteCSV</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">variables</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">loss</span><span class="p p-Indicator">,</span> <span class="nv">fscore</span><span class="p p-Indicator">,</span> <span class="nv">xxx</span><span class="p p-Indicator">]</span>
      <span class="l l-Scalar l-Scalar-Plain">on_unknown_type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">warn</span>
</pre></div>
</div>
</div>
<img src="../_images/inheritance-67dd5e3fedf8cb2cc05150b8210e1a0295a0554e.png" alt="Inheritance diagram of WriteCSV" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="attribute">
<dt id="emloop.hooks.WriteCSV.MISSING_VARIABLE_ACTIONS">
<code class="descname">MISSING_VARIABLE_ACTIONS</code><em class="property"> = ['error', 'warn', 'default']</em><a class="headerlink" href="#emloop.hooks.WriteCSV.MISSING_VARIABLE_ACTIONS" title="Permalink to this definition">¶</a></dt>
<dd><p>Action executed on missing variable.</p>
</dd></dl>

<dl class="attribute">
<dt id="emloop.hooks.WriteCSV.UNKNOWN_TYPE_ACTIONS">
<code class="descname">UNKNOWN_TYPE_ACTIONS</code><em class="property"> = ['error', 'warn', 'default']</em><a class="headerlink" href="#emloop.hooks.WriteCSV.UNKNOWN_TYPE_ACTIONS" title="Permalink to this definition">¶</a></dt>
<dd><p>Action executed on unknown type detection.</p>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.WriteCSV.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>output_dir</em>, <em>output_file='training.csv'</em>, <em>delimiter='</em>, <em>'</em>, <em>default_value=''</em>, <em>variables=None</em>, <em>on_unknown_type='default'</em>, <em>on_missing_variable='error'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/write_csv.html#WriteCSV.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.WriteCSV.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>output_dir</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – directory to save the output CSV</li>
<li><strong>output_file</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – name of the output CSV file</li>
<li><strong>delimiter</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – CSV delimiter</li>
<li><strong>default_value</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – default value to supplement missing variables</li>
<li><strong>variables</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><code class="xref py py-data docutils literal"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Iterable" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>]]) – subset of variable names to be written (all the variables are written by default)</li>
<li><strong>on_unknown_type</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – an action to be taken if the variable value type is not supported (e.g. a list)</li>
<li><strong>on_missing_variable</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – an action to be taken if the variable is specified but not provided</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.WriteCSV._write_header">
<code class="descname">_write_header</code><span class="sig-paren">(</span><em>epoch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/write_csv.html#WriteCSV._write_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.WriteCSV._write_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Write CSV header row with column names.</p>
<p>Column names are inferred from the <code class="docutils literal"><span class="pre">epoch_data</span></code> and <code class="docutils literal"><span class="pre">self.variables</span></code> (if specified).
Variables and streams expected later on are stored in <code class="docutils literal"><span class="pre">self._variables</span></code> and <code class="docutils literal"><span class="pre">self._streams</span></code> respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>epoch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a>]) – epoch data to be logged</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.WriteCSV._write_row">
<code class="descname">_write_row</code><span class="sig-paren">(</span><em>epoch_id</em>, <em>epoch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/write_csv.html#WriteCSV._write_row"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.WriteCSV._write_row" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a single epoch result row to the CSV file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>epoch_id</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>) – epoch number (will be written at the first column)</li>
<li><strong>epoch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a>]) – epoch data</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first simple">
<li><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#KeyError" title="(in Python v3.6)"><strong>KeyError</strong></a> – if the variable is missing and <code class="docutils literal"><span class="pre">self._on_missing_variable</span></code> is set to <code class="docutils literal"><span class="pre">error</span></code></li>
<li><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#TypeError" title="(in Python v3.6)"><strong>TypeError</strong></a> – if the variable has wrong type and  <code class="docutils literal"><span class="pre">self._on_unknown_type</span></code> is set to <code class="docutils literal"><span class="pre">error</span></code></li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">None</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.WriteCSV.after_epoch">
<code class="descname">after_epoch</code><span class="sig-paren">(</span><em>epoch_id</em>, <em>epoch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/write_csv.html#WriteCSV.after_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.WriteCSV.after_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a new row to the CSV file with the given epoch data.</p>
<p>In the case of first invocation, create the CSV header.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>epoch_id</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>) – number of the epoch</li>
<li><strong>epoch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a>]) – epoch data to be logged</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">None</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.StopAfter">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">StopAfter</code><span class="sig-paren">(</span><em>epochs=None</em>, <em>iterations=None</em>, <em>minutes=None</em>, <em>train_stream_name='train'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/stop_after.html#StopAfter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.StopAfter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#emloop.hooks.AbstractHook" title="emloop.hooks.AbstractHook"><code class="xref py py-class docutils literal"><span class="pre">hooks.AbstractHook</span></code></a></p>
<p>Stop the training after any of the specified conditions is met.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">:caption</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">stop the training after 500 epochs</span>
<span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">StopAfter</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">epochs</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">500</span>
</pre></div>
</div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">:caption</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">stop the training after 1000 iterations of 1 hour whichever comes first</span>
<span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">StopAfter</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">minutes</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">60</span>
      <span class="l l-Scalar l-Scalar-Plain">iterations</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
</pre></div>
</div>
<img src="../_images/inheritance-d21871b46b747a716fb70acec6e71df913a61d20.png" alt="Inheritance diagram of StopAfter" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="method">
<dt id="emloop.hooks.StopAfter.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>epochs=None</em>, <em>iterations=None</em>, <em>minutes=None</em>, <em>train_stream_name='train'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/stop_after.html#StopAfter.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.StopAfter.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new StopAfter hook.</p>
<p>Possible stopping conditions are:</p>
<ul class="simple">
<li>after the specified number of epochs</li>
<li>after the specified number of iterations (only train stream batches are counted as iterations)</li>
<li>after the model is trained for more than the specified number of minutes (and <code class="docutils literal"><span class="pre">after_batch</span></code>,         <code class="docutils literal"><span class="pre">after_epoch</span></code> event is triggered)</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>epochs</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><code class="xref py py-data docutils literal"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>]) – stop after the specified number of epochs</li>
<li><strong>iterations</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><code class="xref py py-data docutils literal"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>]) – stop after the specified number of iterations</li>
<li><strong>minutes</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><code class="xref py py-data docutils literal"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">float</span></code></a>]) – stop after the specified number minutes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#ValueError" title="(in Python v3.6)"><strong>ValueError</strong></a> – if no stopping condition is specified</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.StopAfter._check_train_time">
<code class="descname">_check_train_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/stop_after.html#StopAfter._check_train_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.StopAfter._check_train_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop the training if the training time exceeded <code class="docutils literal"><span class="pre">self._minutes</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference internal" href="#emloop.hooks.TrainingTerminated" title="emloop.hooks.TrainingTerminated"><strong>TrainingTerminated</strong></a> – if the training time exceeded <code class="docutils literal"><span class="pre">self._minutes</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.StopAfter.after_batch">
<code class="descname">after_batch</code><span class="sig-paren">(</span><em>stream_name</em>, <em>batch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/stop_after.html#StopAfter.after_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.StopAfter.after_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>If <code class="docutils literal"><span class="pre">stream_name</span></code> equals to <code class="xref py py-attr docutils literal"><span class="pre">emloop.constants.TRAIN_STREAM</span></code>,
increase the iterations counter and possibly stop the training; additionally, call <a class="reference internal" href="#emloop.hooks.StopAfter._check_train_time" title="emloop.hooks.StopAfter._check_train_time"><code class="xref py py-meth docutils literal"><span class="pre">_check_train_time()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>stream_name</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – stream name</li>
<li><strong>batch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Sequence" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Any" title="(in Python v3.6)"><code class="xref py py-data docutils literal"><span class="pre">Any</span></code></a>]]) – ignored</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><a class="reference internal" href="#emloop.hooks.TrainingTerminated" title="emloop.hooks.TrainingTerminated"><strong>TrainingTerminated</strong></a> – if the number of iterations reaches <code class="docutils literal"><span class="pre">self._iters</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">None</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.StopAfter.after_epoch">
<code class="descname">after_epoch</code><span class="sig-paren">(</span><em>epoch_id</em>, <em>epoch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/stop_after.html#StopAfter.after_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.StopAfter.after_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop the training if the <code class="docutils literal"><span class="pre">epoch_id</span></code> reaches <code class="docutils literal"><span class="pre">self._epochs</span></code>; additionally, call <a class="reference internal" href="#emloop.hooks.StopAfter._check_train_time" title="emloop.hooks.StopAfter._check_train_time"><code class="xref py py-meth docutils literal"><span class="pre">_check_train_time()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>epoch_id</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>) – epoch id</li>
<li><strong>epoch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a>]) – ignored</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><a class="reference internal" href="#emloop.hooks.TrainingTerminated" title="emloop.hooks.TrainingTerminated"><strong>TrainingTerminated</strong></a> – if the <code class="docutils literal"><span class="pre">epoch_id</span></code> reaches <code class="docutils literal"><span class="pre">self._epochs</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">None</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.StopAfter.before_training">
<code class="descname">before_training</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/stop_after.html#StopAfter.before_training"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.StopAfter.before_training" title="Permalink to this definition">¶</a></dt>
<dd><p>Start measuring the train time.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.LogVariables">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">LogVariables</code><span class="sig-paren">(</span><em>variables=None</em>, <em>on_unknown_type='ignore'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/log_variables.html#LogVariables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.LogVariables" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#emloop.hooks.AbstractHook" title="emloop.hooks.AbstractHook"><code class="xref py py-class docutils literal"><span class="pre">hooks.AbstractHook</span></code></a></p>
<p>Log the training results to stderr via standard <a class="reference external" href="https://docs.python.org/3.6/library/logging.html#module-logging" title="(in Python v3.6)"><code class="xref py py-mod docutils literal"><span class="pre">logging</span></code></a> module.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">log all the variables</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">LogVariables</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">log only certain variables</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">LogVariables</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">variables</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">loss</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">warn about unsupported variables</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">LogVariables</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">on_unknown_type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">warn</span>
</pre></div>
</div>
</div>
<img src="../_images/inheritance-c8643ee7ea0b94070511d462d37d2a733e2d6091.png" alt="Inheritance diagram of LogVariables" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="attribute">
<dt id="emloop.hooks.LogVariables.UNKNOWN_TYPE_ACTIONS">
<code class="descname">UNKNOWN_TYPE_ACTIONS</code><em class="property"> = ['error', 'warn', 'str', 'ignore']</em><a class="headerlink" href="#emloop.hooks.LogVariables.UNKNOWN_TYPE_ACTIONS" title="Permalink to this definition">¶</a></dt>
<dd><p>Posible actions to take on unknown variable type.</p>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.LogVariables.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>variables=None</em>, <em>on_unknown_type='ignore'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/log_variables.html#LogVariables.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.LogVariables.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new LogVariables hook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>variables</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><code class="xref py py-data docutils literal"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Iterable" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>]]) – variable names to be logged; log all the variables by default</li>
<li><strong>on_unknown_type</strong> – an action to be taken if the variable type is not supported (e.g. a list)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.LogVariables._log_variables">
<code class="descname">_log_variables</code><span class="sig-paren">(</span><em>epoch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/log_variables.html#LogVariables._log_variables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.LogVariables._log_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Log variables from the epoch data.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">At the moment, only scalars and dicts of scalars are properly formatted and logged.
Other value types are ignored by default.</p>
</div>
<p>One may set <code class="docutils literal"><span class="pre">on_unknown_type</span></code> to <code class="docutils literal"><span class="pre">str</span></code> in order to log all the variables anyways.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>epoch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a>]) – epoch data to be logged</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#KeyError" title="(in Python v3.6)"><strong>KeyError</strong></a> – if the specified variable is not found in the stream</li>
<li><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#TypeError" title="(in Python v3.6)"><strong>TypeError</strong></a> – if the variable value is of unsupported type and <code class="docutils literal"><span class="pre">self._on_unknown_type</span></code> is set to <code class="docutils literal"><span class="pre">error</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.LogVariables.after_epoch">
<code class="descname">after_epoch</code><span class="sig-paren">(</span><em>epoch_id</em>, <em>epoch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/log_variables.html#LogVariables.after_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.LogVariables.after_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Log the epoch data via <a class="reference external" href="https://docs.python.org/3.6/library/logging.html#module-logging" title="(in Python v3.6)"><code class="xref py py-mod docutils literal"><span class="pre">logging</span></code></a> API.
Additionally, a blank line is printed directly to stderr to delimit the outputs from other epochs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>epoch_id</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>) – number of processed epoch</li>
<li><strong>epoch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a>]) – epoch data to be logged</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">None</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.LogProfile">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">LogProfile</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/log_profile.html#LogProfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.LogProfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#emloop.hooks.AbstractHook" title="emloop.hooks.AbstractHook"><code class="xref py py-class docutils literal"><span class="pre">hooks.AbstractHook</span></code></a></p>
<p>Summarize and log epoch profile via standard <a class="reference external" href="https://docs.python.org/3.6/library/logging.html#module-logging" title="(in Python v3.6)"><code class="xref py py-mod docutils literal"><span class="pre">logging</span></code></a>.</p>
<p>Epoch profile contains info about time spent training, reading data etc. For full reference, see
<a class="reference internal" href="emloop.html#emloop.MainLoop" title="emloop.MainLoop"><code class="xref py py-class docutils literal"><span class="pre">emloop.MainLoop</span></code></a>.</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">log the time profile after each epoch</span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">LogProfile</span>
</pre></div>
</div>
</div>
<img src="../_images/inheritance-d32d9ba81d5a1a6d381a23e9528b042ef42c7c1c.png" alt="Inheritance diagram of LogProfile" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="method">
<dt id="emloop.hooks.LogProfile.after_epoch_profile">
<code class="descname">after_epoch_profile</code><span class="sig-paren">(</span><em>epoch_id</em>, <em>profile</em>, <em>train_stream_name</em>, <em>extra_streams</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/log_profile.html#LogProfile.after_epoch_profile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.LogProfile.after_epoch_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Summarize and log the given epoch profile.</p>
<dl class="docutils">
<dt>The profile is expected to contain at least:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">read_data_train</span></code>, <code class="docutils literal"><span class="pre">eval_batch_train</span></code> and <code class="docutils literal"><span class="pre">after_batch_hooks_train</span></code> entries produced by the train
stream (if train stream name is <cite>train</cite>)</li>
<li><code class="docutils literal"><span class="pre">after_epoch_hooks</span></code> entry</li>
</ul>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>profile</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.List" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">float</span></code></a>]]) – epoch timings profile</li>
<li><strong>extra_streams</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Iterable" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>]) – enumeration of additional stream names</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">None</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.LogDir">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">LogDir</code><span class="sig-paren">(</span><em>output_dir</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/log_dir.html#LogDir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.LogDir" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#emloop.hooks.AbstractHook" title="emloop.hooks.AbstractHook"><code class="xref py py-class docutils literal"><span class="pre">hooks.AbstractHook</span></code></a></p>
<p>Log the output dir before training, after each epoch and after training.</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">log the training dir</span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">LogDir</span>
</pre></div>
</div>
</div>
<img src="../_images/inheritance-34bc9f8dab08a06801b7c2b1f5424b38b20af47a.png" alt="Inheritance diagram of LogDir" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="method">
<dt id="emloop.hooks.LogDir.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>output_dir</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/log_dir.html#LogDir.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.LogDir.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new LogDir hook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>output_dir</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – training output directory</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.LogDir.after_epoch">
<code class="descname">after_epoch</code><span class="sig-paren">(</span><em>**_</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/log_dir.html#LogDir.after_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.LogDir.after_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Log the output directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.LogDir.after_training">
<code class="descname">after_training</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/log_dir.html#LogDir.after_training"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.LogDir.after_training" title="Permalink to this definition">¶</a></dt>
<dd><p>Log the output directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.LogDir.before_training">
<code class="descname">before_training</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/log_dir.html#LogDir.before_training"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.LogDir.before_training" title="Permalink to this definition">¶</a></dt>
<dd><p>Log the output directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.SaveEvery">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">SaveEvery</code><span class="sig-paren">(</span><em>model</em>, <em>on_failure='error'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/save.html#SaveEvery"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.SaveEvery" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">emloop.hooks.every_n_epoch.EveryNEpoch</span></code></p>
<p>Save the model every <code class="docutils literal"><span class="pre">n_epochs</span></code> epoch.</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">save every 10th epoch</span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SaveEvery</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">n_epochs</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">save every epoch and only warn on failure</span><a class="headerlink" href="#id10" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SaveEvery</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">on_failure</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">warn</span>
</pre></div>
</div>
</div>
<img src="../_images/inheritance-2e3bfe7fb2405ba4e1023237180af7d97b512587.png" alt="Inheritance diagram of SaveEvery" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="attribute">
<dt id="emloop.hooks.SaveEvery.SAVE_FAILURE_ACTIONS">
<code class="descname">SAVE_FAILURE_ACTIONS</code><em class="property"> = ['error', 'warn', 'ignore']</em><a class="headerlink" href="#emloop.hooks.SaveEvery.SAVE_FAILURE_ACTIONS" title="Permalink to this definition">¶</a></dt>
<dd><p>Action to be executed when model save fails.</p>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.SaveEvery.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>model</em>, <em>on_failure='error'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/save.html#SaveEvery.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.SaveEvery.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> (<a class="reference internal" href="emloop.models.html#emloop.models.AbstractModel" title="emloop.models.AbstractModel"><code class="xref py py-class docutils literal"><span class="pre">AbstractModel</span></code></a>) – trained model</li>
<li><strong>on_failure</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – action to be taken when model fails to save itself; one of <a class="reference internal" href="#emloop.hooks.SaveEvery.SAVE_FAILURE_ACTIONS" title="emloop.hooks.SaveEvery.SAVE_FAILURE_ACTIONS"><code class="xref py py-attr docutils literal"><span class="pre">SAVE_FAILURE_ACTIONS</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.SaveEvery._after_n_epoch">
<code class="descname">_after_n_epoch</code><span class="sig-paren">(</span><em>epoch_id</em>, <em>**_</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/save.html#SaveEvery._after_n_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.SaveEvery._after_n_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model every <code class="docutils literal"><span class="pre">n_epochs</span></code> epoch.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>epoch_id</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>) – number of the processed epoch</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="emloop.hooks.SaveEvery.save_model">
<em class="property">static </em><code class="descname">save_model</code><span class="sig-paren">(</span><em>model</em>, <em>name_suffix</em>, <em>on_failure</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/save.html#SaveEvery.save_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.SaveEvery.save_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the given model with the given name_suffix. On failure, take the specified action.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>model</strong> (<a class="reference internal" href="emloop.models.html#emloop.models.AbstractModel" title="emloop.models.AbstractModel"><code class="xref py py-class docutils literal"><span class="pre">AbstractModel</span></code></a>) – the model to be saved</li>
<li><strong>name_suffix</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – name to be used for saving</li>
<li><strong>on_failure</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – action to be taken on failure; one of <a class="reference internal" href="#emloop.hooks.SaveEvery.SAVE_FAILURE_ACTIONS" title="emloop.hooks.SaveEvery.SAVE_FAILURE_ACTIONS"><code class="xref py py-attr docutils literal"><span class="pre">SAVE_FAILURE_ACTIONS</span></code></a></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#IOError" title="(in Python v3.6)"><strong>IOError</strong></a> – on save failure with <code class="docutils literal"><span class="pre">on_failure</span></code> set to <code class="docutils literal"><span class="pre">error</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">None</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.SaveBest">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">SaveBest</code><span class="sig-paren">(</span><em>model</em>, <em>variable='loss'</em>, <em>condition='min'</em>, <em>stream='valid'</em>, <em>aggregation='mean'</em>, <em>on_save_failure='error'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/save.html#SaveBest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.SaveBest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#emloop.hooks.AbstractHook" title="emloop.hooks.AbstractHook"><code class="xref py py-class docutils literal"><span class="pre">hooks.AbstractHook</span></code></a></p>
<p>Maintain the best performing model given the specified criteria.</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">save model with minimal valid loss</span><a class="headerlink" href="#id11" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SaveBest</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">save model with max accuracy</span><a class="headerlink" href="#id12" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SaveBest</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">variable</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">accuracy</span>
      <span class="l l-Scalar l-Scalar-Plain">condition</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">max</span>
</pre></div>
</div>
</div>
<img src="../_images/inheritance-99dcb2f3cc997419aae7c87d7a957be2e227aef6.png" alt="Inheritance diagram of SaveBest" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="attribute">
<dt id="emloop.hooks.SaveBest.OBJECTIVES">
<code class="descname">OBJECTIVES</code><em class="property"> = {'max', 'min'}</em><a class="headerlink" href="#emloop.hooks.SaveBest.OBJECTIVES" title="Permalink to this definition">¶</a></dt>
<dd><p>Possible objectives for the monitor variable.</p>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.SaveBest.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>model</em>, <em>variable='loss'</em>, <em>condition='min'</em>, <em>stream='valid'</em>, <em>aggregation='mean'</em>, <em>on_save_failure='error'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/save.html#SaveBest.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.SaveBest.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Example: metric=loss, condition=min -&gt; saved the model when the loss is best so far (on <cite>stream</cite>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> (<a class="reference internal" href="emloop.models.html#emloop.models.AbstractModel" title="emloop.models.AbstractModel"><code class="xref py py-class docutils literal"><span class="pre">AbstractModel</span></code></a>) – trained model</li>
<li><strong>variable</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – variable name to be monitored</li>
<li><strong>condition</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – performance objective; one of <a class="reference internal" href="#emloop.hooks.SaveBest.OBJECTIVES" title="emloop.hooks.SaveBest.OBJECTIVES"><code class="xref py py-attr docutils literal"><span class="pre">OBJECTIVES</span></code></a></li>
<li><strong>stream</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – stream name to be monitored</li>
<li><strong>aggregation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – variable aggregation to be used (<code class="docutils literal"><span class="pre">mean</span></code> by default)</li>
<li><strong>on_save_failure</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – action to be taken when model fails to save itself, one of
<a class="reference internal" href="#emloop.hooks.SaveEvery.SAVE_FAILURE_ACTIONS" title="emloop.hooks.SaveEvery.SAVE_FAILURE_ACTIONS"><code class="xref py py-attr docutils literal"><span class="pre">SaveEvery.SAVE_FAILURE_ACTIONS</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.SaveBest._get_value">
<code class="descname">_get_value</code><span class="sig-paren">(</span><em>epoch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/save.html#SaveBest._get_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.SaveBest._get_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the value of the monitored variable from the given epoch data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>epoch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a>]) – epoch data which determine whether the model will be saved or not</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first simple">
<li><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#KeyError" title="(in Python v3.6)"><strong>KeyError</strong></a> – if any of the specified stream, variable or aggregation is not present in the <code class="docutils literal"><span class="pre">epoch_data</span></code></li>
<li><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#TypeError" title="(in Python v3.6)"><strong>TypeError</strong></a> – if the variable value is not a dict when aggregation is specified</li>
<li><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#ValueError" title="(in Python v3.6)"><strong>ValueError</strong></a> – if the variable value is not a scalar</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">float</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.SaveBest._is_value_better">
<code class="descname">_is_value_better</code><span class="sig-paren">(</span><em>new_value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/save.html#SaveBest._is_value_better"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.SaveBest._is_value_better" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if the new value is better than the best so far.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>new_value</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">float</span></code></a>) – current value of the objective function</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.SaveBest.after_epoch">
<code class="descname">after_epoch</code><span class="sig-paren">(</span><em>epoch_data</em>, <em>**_</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/save.html#SaveBest.after_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.SaveBest.after_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model if the new value of the monitored variable is better than the best value so far.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>epoch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a>]) – epoch data to be processed</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.SaveLatest">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">SaveLatest</code><span class="sig-paren">(</span><em>model</em>, <em>on_save_failure='error'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/save.html#SaveLatest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.SaveLatest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#emloop.hooks.AbstractHook" title="emloop.hooks.AbstractHook"><code class="xref py py-class docutils literal"><span class="pre">hooks.AbstractHook</span></code></a></p>
<p>Save the latest model.</p>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text">save the latest model</span><a class="headerlink" href="#id13" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SaveLatest</span>
</pre></div>
</div>
</div>
<img src="../_images/inheritance-fea04b06f0f63761aa2879f939673eb6ce9dbd37.png" alt="Inheritance diagram of SaveLatest" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="method">
<dt id="emloop.hooks.SaveLatest.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>model</em>, <em>on_save_failure='error'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/save.html#SaveLatest.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.SaveLatest.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new SaveLatest hook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> (<a class="reference internal" href="emloop.models.html#emloop.models.AbstractModel" title="emloop.models.AbstractModel"><code class="xref py py-class docutils literal"><span class="pre">AbstractModel</span></code></a>) – trained model</li>
<li><strong>on_save_failure</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – action to be taken when model fails to save itself, one of
<a class="reference internal" href="#emloop.hooks.SaveEvery.SAVE_FAILURE_ACTIONS" title="emloop.hooks.SaveEvery.SAVE_FAILURE_ACTIONS"><code class="xref py py-attr docutils literal"><span class="pre">SaveEvery.SAVE_FAILURE_ACTIONS</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.SaveLatest.after_epoch">
<code class="descname">after_epoch</code><span class="sig-paren">(</span><em>**_</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/save.html#SaveLatest.after_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.SaveLatest.after_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Save/override the latest model after every epoch.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.ComputeStats">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">ComputeStats</code><span class="sig-paren">(</span><em>variables</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/compute_stats.html#ComputeStats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.ComputeStats" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">emloop.hooks.accumulate_variables.AccumulateVariables</span></code></p>
<p>Accumulate the specified variables, compute the specified aggregation values and save them to the epoch data.</p>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text">compute loss and accuracy means after each epoch</span><a class="headerlink" href="#id14" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ComputeStats</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">variables</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">loss</span><span class="p p-Indicator">,</span> <span class="nv">accuracy</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-text">compute min and max loss after each epoch</span><a class="headerlink" href="#id15" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ComputeStats</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">variables</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">loss</span> <span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">min</span><span class="p p-Indicator">,</span> <span class="nv">max</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</div>
<img src="../_images/inheritance-8a2fdcc8708c1e39334912fc5190eb368cea856e.png" alt="Inheritance diagram of ComputeStats" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="attribute">
<dt id="emloop.hooks.ComputeStats.EXTRA_AGGREGATIONS">
<code class="descname">EXTRA_AGGREGATIONS</code><em class="property"> = {'nanfraction', 'nancount'}</em><a class="headerlink" href="#emloop.hooks.ComputeStats.EXTRA_AGGREGATIONS" title="Permalink to this definition">¶</a></dt>
<dd><p>Extra aggregation methods extending the set of all NumPy functions.</p>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.ComputeStats.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>variables</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/compute_stats.html#ComputeStats.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.ComputeStats.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new stats hook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>variables</strong> – list of variables mapping: <code class="docutils literal"><span class="pre">variable_name</span></code> -&gt; <code class="docutils literal"><span class="pre">List</span></code> [<code class="docutils literal"><span class="pre">aggregations</span></code>…] wherein
<code class="docutils literal"><span class="pre">aggregations</span></code> are the names of arbitrary NumPy functions returning a scalar (e.g., <code class="docutils literal"><span class="pre">'mean'</span></code>,
<code class="docutils literal"><span class="pre">'nanmean'</span></code>, <code class="docutils literal"><span class="pre">'max'</span></code>, etc.) or one of <a class="reference internal" href="#emloop.hooks.ComputeStats.EXTRA_AGGREGATIONS" title="emloop.hooks.ComputeStats.EXTRA_AGGREGATIONS"><code class="xref py py-attr docutils literal"><span class="pre">EXTRA_AGGREGATIONS</span></code></a>. Passing just the
<code class="docutils literal"><span class="pre">variable</span> <span class="pre">name</span></code> instead of a mapping is the same as passing {variable_name: [‘mean’]}.</li>
<li><strong>kwargs</strong> – Ignored</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#ValueError" title="(in Python v3.6)"><strong>ValueError</strong></a> – if the specified aggregation function is not supported</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="emloop.hooks.ComputeStats._compute_aggregation">
<em class="property">static </em><code class="descname">_compute_aggregation</code><span class="sig-paren">(</span><em>aggregation</em>, <em>data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/compute_stats.html#ComputeStats._compute_aggregation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.ComputeStats._compute_aggregation" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the specified aggregation on the given data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>aggregation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – the name of an arbitrary NumPy function (e.g., mean, max, median, nanmean, …)
or one of <a class="reference internal" href="#emloop.hooks.ComputeStats.EXTRA_AGGREGATIONS" title="emloop.hooks.ComputeStats.EXTRA_AGGREGATIONS"><code class="xref py py-attr docutils literal"><span class="pre">EXTRA_AGGREGATIONS</span></code></a>.</li>
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Iterable" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Any" title="(in Python v3.6)"><code class="xref py py-data docutils literal"><span class="pre">Any</span></code></a>]) – data to be aggregated</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#ValueError" title="(in Python v3.6)"><strong>ValueError</strong></a> – if the specified aggregation is not supported or found in NumPy</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="emloop.hooks.ComputeStats._raise_check_aggregation">
<em class="property">static </em><code class="descname">_raise_check_aggregation</code><span class="sig-paren">(</span><em>aggregation</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/compute_stats.html#ComputeStats._raise_check_aggregation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.ComputeStats._raise_check_aggregation" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the given aggregation is present in NumPy or it is one of EXTRA_AGGREGATIONS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>aggregation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – the aggregation name</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#ValueError" title="(in Python v3.6)"><strong>ValueError</strong></a> – if the specified aggregation is not supported or found in NumPy</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.ComputeStats._save_stats">
<code class="descname">_save_stats</code><span class="sig-paren">(</span><em>epoch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/compute_stats.html#ComputeStats._save_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.ComputeStats._save_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Extend <code class="docutils literal"><span class="pre">epoch_data</span></code> by stream:variable:aggreagation data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>epoch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a>]) – data source from which the statistics are computed</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.ComputeStats.after_epoch">
<code class="descname">after_epoch</code><span class="sig-paren">(</span><em>epoch_data</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/compute_stats.html#ComputeStats.after_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.ComputeStats.after_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the specified aggregations and save them to the given epoch data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>epoch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a>]) – epoch data to be processed</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.Check">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">Check</code><span class="sig-paren">(</span><em>variable</em>, <em>required_min_value</em>, <em>max_epoch</em>, <em>stream='valid'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/check.html#Check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.Check" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#emloop.hooks.AbstractHook" title="emloop.hooks.AbstractHook"><code class="xref py py-class docutils literal"><span class="pre">hooks.AbstractHook</span></code></a></p>
<p>Terminate training if the given stream variable exceeds the threshold in at most specified number of epochs.</p>
<p>Raise <a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#ValueError" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">ValueError</span></code></a> if the threshold was not exceeded in given number of epochs</p>
<div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-text">exceed 95% accuracy on valid (default) stream within at most 10 epochs</span><a class="headerlink" href="#id16" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Check</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">variable</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">accuracy</span>
      <span class="l l-Scalar l-Scalar-Plain">required_min_value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">0.93</span>
      <span class="l l-Scalar l-Scalar-Plain">max_epoch</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
</pre></div>
</div>
</div>
<img src="../_images/inheritance-0323029aa5edd98d77bbfca13db0709be8b7162b.png" alt="Inheritance diagram of Check" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="method">
<dt id="emloop.hooks.Check.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>variable</em>, <em>required_min_value</em>, <em>max_epoch</em>, <em>stream='valid'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/check.html#Check.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.Check.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new Check hook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>variable</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – variable to be checked</li>
<li><strong>required_min_value</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">float</span></code></a>) – threshold to be exceeded</li>
<li><strong>max_epoch</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>) – maximum epochs to be run</li>
<li><strong>stream</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – stream to be checked</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.Check.after_epoch">
<code class="descname">after_epoch</code><span class="sig-paren">(</span><em>epoch_id</em>, <em>epoch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/check.html#Check.after_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.Check.after_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Check termination conditions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>epoch_id</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>) – number of the processed epoch</li>
<li><strong>epoch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a>]) – epoch data to be checked</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#KeyError" title="(in Python v3.6)"><strong>KeyError</strong></a> – if the stream of variable was not found in <code class="docutils literal"><span class="pre">epoch_data</span></code></li>
<li><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#TypeError" title="(in Python v3.6)"><strong>TypeError</strong></a> – if the monitored variable is not a scalar or scalar <code class="docutils literal"><span class="pre">mean</span></code> aggregation</li>
<li><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#ValueError" title="(in Python v3.6)"><strong>ValueError</strong></a> – if the specified number of epochs exceeded</li>
<li><a class="reference internal" href="#emloop.hooks.TrainingTerminated" title="emloop.hooks.TrainingTerminated"><strong>TrainingTerminated</strong></a> – if the monitor variable is above the required level</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.ShowProgress">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">ShowProgress</code><span class="sig-paren">(</span><em>dataset</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/show_progress.html#ShowProgress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.ShowProgress" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#emloop.hooks.AbstractHook" title="emloop.hooks.AbstractHook"><code class="xref py py-class docutils literal"><span class="pre">hooks.AbstractHook</span></code></a></p>
<p>Show stream progresses and ETA in the current epoch.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">If the dataset provides <code class="docutils literal"><span class="pre">num_batches</span></code> property, the hook will be able to display the progress and ETA for the
1st epoch as well. The property should return a mapping of <code class="docutils literal"><span class="pre">&lt;stream</span> <span class="pre">name&gt;</span></code> -&gt; <code class="docutils literal"><span class="pre">&lt;batch</span> <span class="pre">count&gt;</span></code>.</p>
</div>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last"><code class="docutils literal"><span class="pre">ShowProgress</span></code> hook should be placed as the first in hooks config section, otherwise 
the progress bar may not be displayed correctly.</p>
</div>
<div class="literal-block-wrapper docutils container" id="id17">
<div class="code-block-caption"><span class="caption-text">show progress of the current epoch</span><a class="headerlink" href="#id17" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ShowProgress</span>
</pre></div>
</div>
</div>
<img src="../_images/inheritance-2604fa39c417eb4cc229873d63e2c38e3bb75542.png" alt="Inheritance diagram of ShowProgress" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="method">
<dt id="emloop.hooks.ShowProgress.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>dataset</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/show_progress.html#ShowProgress.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.ShowProgress.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new ShowProgress hook.</p>
<p>Fetch the batch counts from <code class="docutils literal"><span class="pre">dataset.num_batches</span></code> property if available.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dataset</strong> (<a class="reference internal" href="emloop.datasets.html#emloop.datasets.AbstractDataset" title="emloop.datasets.AbstractDataset"><code class="xref py py-class docutils literal"><span class="pre">AbstractDataset</span></code></a>) – training dataset</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.ShowProgress.after_batch">
<code class="descname">after_batch</code><span class="sig-paren">(</span><em>stream_name</em>, <em>batch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/show_progress.html#ShowProgress.after_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.ShowProgress.after_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Display the progress and ETA for the current stream in the epoch.
If the stream size (total batch count) is unknown (1st epoch), print only the number of processed batches.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.ShowProgress.after_epoch">
<code class="descname">after_epoch</code><span class="sig-paren">(</span><em>**_</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/show_progress.html#ShowProgress.after_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.ShowProgress.after_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset progress counters. Save <code class="docutils literal"><span class="pre">total_batch_count</span></code> after the 1st epoch.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.EveryNEpoch">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">EveryNEpoch</code><span class="sig-paren">(</span><em>n_epochs=1</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/every_n_epoch.html#EveryNEpoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.EveryNEpoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#emloop.hooks.AbstractHook" title="emloop.hooks.AbstractHook"><code class="xref py py-class docutils literal"><span class="pre">hooks.AbstractHook</span></code></a></p>
<p>This hook should be used as base hook in the case when some action need to be processed every n epoch.
Call <code class="docutils literal"><span class="pre">_after_n_epoch</span></code> method every <code class="docutils literal"><span class="pre">n_epochs</span></code> epoch.</p>
<img src="../_images/inheritance-005a560090a404d04f99cf3e448359e71b0123ed.png" alt="Inheritance diagram of EveryNEpoch" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="method">
<dt id="emloop.hooks.EveryNEpoch.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>n_epochs=1</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/every_n_epoch.html#EveryNEpoch.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.EveryNEpoch.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create EveryNEpoch hook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n_epochs</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>) – how often <code class="docutils literal"><span class="pre">_after_n_epoch</span></code> method is called</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.EveryNEpoch._after_n_epoch">
<code class="descname">_after_n_epoch</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/every_n_epoch.html#EveryNEpoch._after_n_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.EveryNEpoch._after_n_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method which is called every <cite>n_epochs</cite> epoch.
This method must be overridden.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#TypeError" title="(in Python v3.6)"><strong>TypeError</strong></a> – if this method is not overridden</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.EveryNEpoch.after_epoch">
<code class="descname">after_epoch</code><span class="sig-paren">(</span><em>epoch_id</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/every_n_epoch.html#EveryNEpoch.after_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.EveryNEpoch.after_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Call <code class="docutils literal"><span class="pre">_after_n_epoch</span></code> method every <code class="docutils literal"><span class="pre">n_epochs</span></code> epoch.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>epoch_id</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>) – number of the processed epoch</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.OnPlateau">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">OnPlateau</code><span class="sig-paren">(</span><em>long_term=50</em>, <em>short_term=10</em>, <em>stream='valid'</em>, <em>variable='loss'</em>, <em>objective='min'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/on_plateau.html#OnPlateau"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.OnPlateau" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">emloop.hooks.compute_stats.ComputeStats</span></code></p>
<p>Base hook for hooks taking actions when certain variable reaches its plateau.
The variable is observed on epoch level and plateau is reached when
its <code class="docutils literal"><span class="pre">long_term</span></code> mean is lower/greater than the <code class="docutils literal"><span class="pre">short_term</span></code> mean.</p>
<p>Call <a class="reference internal" href="#emloop.hooks.OnPlateau._on_plateau_action" title="emloop.hooks.OnPlateau._on_plateau_action"><code class="xref py py-meth docutils literal"><span class="pre">_on_plateau_action()</span></code></a> method when the observed variable reaches its plateau.</p>
<img src="../_images/inheritance-a36177f516ac7dfd30f57863f0ceea55f15da69f.png" alt="Inheritance diagram of OnPlateau" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="attribute">
<dt id="emloop.hooks.OnPlateau.OBJECTIVES">
<code class="descname">OBJECTIVES</code><em class="property"> = {'max', 'min'}</em><a class="headerlink" href="#emloop.hooks.OnPlateau.OBJECTIVES" title="Permalink to this definition">¶</a></dt>
<dd><p>Possible objectives for the observed variable.</p>
</dd></dl>

<dl class="attribute">
<dt id="emloop.hooks.OnPlateau._AGGREGATION">
<code class="descname">_AGGREGATION</code><em class="property"> = 'mean'</em><a class="headerlink" href="#emloop.hooks.OnPlateau._AGGREGATION" title="Permalink to this definition">¶</a></dt>
<dd><p>Epoch aggregation method of the observed variable.</p>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.OnPlateau.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>long_term=50</em>, <em>short_term=10</em>, <em>stream='valid'</em>, <em>variable='loss'</em>, <em>objective='min'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/on_plateau.html#OnPlateau.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.OnPlateau.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new OnPlateau hook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>long_term</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>) – count of last epochs representing long training period</li>
<li><strong>short_term</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>) – count of last epochs representing short training period</li>
<li><strong>stream</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – name of the processed stream</li>
<li><strong>variable</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – name of the observed variable</li>
<li><strong>objective</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – observed variable objective; one of <a class="reference internal" href="#emloop.hooks.OnPlateau.OBJECTIVES" title="emloop.hooks.OnPlateau.OBJECTIVES"><code class="xref py py-attr docutils literal"><span class="pre">OnPlateau.OBJECTIVES</span></code></a></li>
<li><strong>kwargs</strong> – ignored</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#AssertionError" title="(in Python v3.6)"><strong>AssertionError</strong></a> – if <code class="docutils literal"><span class="pre">long_term</span></code> &lt; <code class="docutils literal"><span class="pre">short_term</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.OnPlateau._on_plateau_action">
<code class="descname">_on_plateau_action</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/on_plateau.html#OnPlateau._on_plateau_action"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.OnPlateau._on_plateau_action" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method which is called when the observed variable reaches its plateau.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.OnPlateau.after_epoch">
<code class="descname">after_epoch</code><span class="sig-paren">(</span><em>epoch_id</em>, <em>epoch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/on_plateau.html#OnPlateau.after_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.OnPlateau.after_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Call <a class="reference internal" href="#emloop.hooks.OnPlateau._on_plateau_action" title="emloop.hooks.OnPlateau._on_plateau_action"><code class="xref py py-meth docutils literal"><span class="pre">_on_plateau_action()</span></code></a> if the <code class="docutils literal"><span class="pre">long_term</span></code>
variable mean is lower/greater than the <code class="docutils literal"><span class="pre">short_term</span></code> mean.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.StopOnPlateau">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">StopOnPlateau</code><span class="sig-paren">(</span><em>long_term=50</em>, <em>short_term=10</em>, <em>stream='valid'</em>, <em>variable='loss'</em>, <em>objective='min'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/stop_on_plateau.html#StopOnPlateau"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.StopOnPlateau" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">emloop.hooks.on_plateau.OnPlateau</span></code></p>
<p>Terminate the training when the observed variable reaches its plateau.</p>
<div class="literal-block-wrapper docutils container" id="id18">
<div class="code-block-caption"><span class="caption-text">stop the training when the mean of last 100 valid <code class="docutils literal"><span class="pre">loss</span></code> values is
smaller than the mean of last 30 <code class="docutils literal"><span class="pre">loss</span></code> values.</span><a class="headerlink" href="#id18" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">StopOnPlateau</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">long_term</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
      <span class="l l-Scalar l-Scalar-Plain">short_term</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">30</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id19">
<div class="code-block-caption"><span class="caption-text">stop the training when accuracy stops improving (raising)</span><a class="headerlink" href="#id19" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">StopOnPlateau</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">variable</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">accuracy</span>
      <span class="l l-Scalar l-Scalar-Plain">objective</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">max</span>
</pre></div>
</div>
</div>
<img src="../_images/inheritance-7b2ca9016eb558f3e7093027db0a6cc97e29f3df.png" alt="Inheritance diagram of StopOnPlateau" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="method">
<dt id="emloop.hooks.StopOnPlateau._on_plateau_action">
<code class="descname">_on_plateau_action</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/stop_on_plateau.html#StopOnPlateau._on_plateau_action"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.StopOnPlateau._on_plateau_action" title="Permalink to this definition">¶</a></dt>
<dd><p>Terminate the training when the observed variable reaches its plateau.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference internal" href="#emloop.hooks.TrainingTerminated" title="emloop.hooks.TrainingTerminated"><strong>TrainingTerminated</strong></a> – if the model stops improving</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.StopOnNaN">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">StopOnNaN</code><span class="sig-paren">(</span><em>variables=None</em>, <em>on_unknown_type='ignore'</em>, <em>stop_on_inf=False</em>, <em>after_batch=False</em>, <em>after_epoch=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/stop_on_nan.html#StopOnNaN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.StopOnNaN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#emloop.hooks.AbstractHook" title="emloop.hooks.AbstractHook"><code class="xref py py-class docutils literal"><span class="pre">hooks.AbstractHook</span></code></a></p>
<p>Stop the training when any of the specified variables contain NaN.</p>
<div class="literal-block-wrapper docutils container" id="id20">
<div class="code-block-caption"><span class="caption-text">stop as soon as any variable contains NaN</span><a class="headerlink" href="#id20" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">StopOnNaN</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id21">
<div class="code-block-caption"><span class="caption-text">stop on NaN in loss variable</span><a class="headerlink" href="#id21" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">StopOnNan</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">variables</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">loss</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</div>
<img src="../_images/inheritance-cd3b42cbd7dd6a5e49c802b37d9bae74ea4c322a.png" alt="Inheritance diagram of StopOnNaN" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="attribute">
<dt id="emloop.hooks.StopOnNaN.UNKNOWN_TYPE_ACTIONS">
<code class="descname">UNKNOWN_TYPE_ACTIONS</code><em class="property"> = ['error', 'warn', 'ignore']</em><a class="headerlink" href="#emloop.hooks.StopOnNaN.UNKNOWN_TYPE_ACTIONS" title="Permalink to this definition">¶</a></dt>
<dd><p>Posible actions to take on unknown variable type.</p>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.StopOnNaN.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>variables=None</em>, <em>on_unknown_type='ignore'</em>, <em>stop_on_inf=False</em>, <em>after_batch=False</em>, <em>after_epoch=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/stop_on_nan.html#StopOnNaN.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.StopOnNaN.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new StopOnNaN hook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>variables</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><code class="xref py py-data docutils literal"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Iterable" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>]]) – variable names to be checked; check all variables in <code class="docutils literal"><span class="pre">epoch_data</span></code> by default</li>
<li><strong>on_unkown_type</strong> – option for handling unknown data types, possible options are <code class="docutils literal"><span class="pre">'warn'</span></code>, <code class="docutils literal"><span class="pre">'error'</span></code> and                default <code class="docutils literal"><span class="pre">'ignore'</span></code></li>
<li><strong>stop_on_inf</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a>) – if <cite>True</cite> consider infinity values as NaN, default is <cite>False</cite></li>
<li><strong>after_batch</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a>) – check data after each batch? default is <cite>False</cite></li>
<li><strong>after_epoch</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a>) – check data after each epoch? default is <cite>True</cite></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#AssertionError" title="(in Python v3.6)"><strong>AssertionError</strong></a> – for undefined <code class="docutils literal"><span class="pre">on_unknown_type</span></code></li>
<li><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#AssertionError" title="(in Python v3.6)"><strong>AssertionError</strong></a> – if both <code class="docutils literal"><span class="pre">after_batch</span></code> and <code class="docutils literal"><span class="pre">after_epoch</span></code> are <cite>False</cite></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.StopOnNaN._check_nan">
<code class="descname">_check_nan</code><span class="sig-paren">(</span><em>epoch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/stop_on_nan.html#StopOnNaN._check_nan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.StopOnNaN._check_nan" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise an exception when some of the monitored data is NaN.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>epoch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a>]) – epoch data checked</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first simple">
<li><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#KeyError" title="(in Python v3.6)"><strong>KeyError</strong></a> – if the specified variable is not found in the stream</li>
<li><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#ValueError" title="(in Python v3.6)"><strong>ValueError</strong></a> – if the variable value is of unsupported type and <code class="docutils literal"><span class="pre">self._on_unknown_type</span></code> is set to <code class="docutils literal"><span class="pre">error</span></code></li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">None</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.StopOnNaN._is_nan">
<code class="descname">_is_nan</code><span class="sig-paren">(</span><em>variable</em>, <em>data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/stop_on_nan.html#StopOnNaN._is_nan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.StopOnNaN._is_nan" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively search passed data and find NaNs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>variable</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – name of variable to be checked</li>
<li><strong>data</strong> – data object (dict, list, scalar)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><cite>True</cite> if there is a NaN value in the data; <cite>False</cite> otherwise.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#ValueError" title="(in Python v3.6)"><strong>ValueError</strong></a> – if the variable value is of unsupported type and <code class="docutils literal"><span class="pre">on_unknown_type</span></code> is set to <code class="docutils literal"><span class="pre">error</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.StopOnNaN.after_batch">
<code class="descname">after_batch</code><span class="sig-paren">(</span><em>stream_name</em>, <em>batch_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/stop_on_nan.html#StopOnNaN.after_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.StopOnNaN.after_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>If initialized to check after each batch, stop the training once the batch data contains a monitored
variable equal to NaN.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>stream_name</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – name of the stream to be checked</li>
<li><strong>batch_data</strong> – batch data to be checked</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">None</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.StopOnNaN.after_epoch">
<code class="descname">after_epoch</code><span class="sig-paren">(</span><em>epoch_data</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/stop_on_nan.html#StopOnNaN.after_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.StopOnNaN.after_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>If initialized to check after each epoch, stop the training once the epoch data contains a monitored
variable equal to NaN.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>epoch_data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#object" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a>]) – epoch data to be checked</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="emloop.hooks.SaveConfusionMatrix">
<em class="property">class </em><code class="descclassname">emloop.hooks.</code><code class="descname">SaveConfusionMatrix</code><span class="sig-paren">(</span><em>output_dir</em>, <em>dataset</em>, <em>labels_name='labels'</em>, <em>predictions_name='predictions'</em>, <em>classes_names=None</em>, <em>figsize=None</em>, <em>figure_action='save'</em>, <em>num_classes_method_name='num_classes'</em>, <em>classes_names_method_name='classes_names'</em>, <em>mask_name=None</em>, <em>normalize=True</em>, <em>cmap='Blues'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/save_cm.html#SaveConfusionMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.SaveConfusionMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">emloop.hooks.accumulate_variables.AccumulateVariables</span></code></p>
<p>After each epoch, compute and save/store confusion matrix figure for the predicted and expected labels.</p>
<div class="literal-block-wrapper docutils container" id="id22">
<div class="code-block-caption"><span class="caption-text">Store confusion matrix figure to epoch data with green colorbar</span><a class="headerlink" href="#id22" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SaveConfusionMatrix</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">figure_action</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">store</span>
      <span class="l l-Scalar l-Scalar-Plain">cmap</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Greens</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id23">
<div class="code-block-caption"><span class="caption-text">Defined classes’ names and save confusion matrix figure to training logdir with absolute values</span><a class="headerlink" href="#id23" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SaveConfusionMatrix</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">classes_names</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">class_with_index_zero</span><span class="p p-Indicator">,</span> <span class="nv">class_with_index_one</span><span class="p p-Indicator">,</span> <span class="nv">class_with_index_three</span><span class="p p-Indicator">]</span>
      <span class="l l-Scalar l-Scalar-Plain">normalize</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
</pre></div>
</div>
</div>
<img src="../_images/inheritance-6c8c76ab13436eb338225b0f2b2fe2b75c40e668.png" alt="Inheritance diagram of SaveConfusionMatrix" class="inheritance"/>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="attribute">
<dt id="emloop.hooks.SaveConfusionMatrix.FIGURE_ACTIONS">
<code class="descname">FIGURE_ACTIONS</code><em class="property"> = ['save', 'store']</em><a class="headerlink" href="#emloop.hooks.SaveConfusionMatrix.FIGURE_ACTIONS" title="Permalink to this definition">¶</a></dt>
<dd><p>Possible actions to be taken with the plotted figure.
It can be either saved to a file or stored in the epoch data.</p>
</dd></dl>

<dl class="method">
<dt id="emloop.hooks.SaveConfusionMatrix.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>output_dir</em>, <em>dataset</em>, <em>labels_name='labels'</em>, <em>predictions_name='predictions'</em>, <em>classes_names=None</em>, <em>figsize=None</em>, <em>figure_action='save'</em>, <em>num_classes_method_name='num_classes'</em>, <em>classes_names_method_name='classes_names'</em>, <em>mask_name=None</em>, <em>normalize=True</em>, <em>cmap='Blues'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emloop/hooks/save_cm.html#SaveConfusionMatrix.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.SaveConfusionMatrix.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new <a class="reference internal" href="#emloop.hooks.SaveConfusionMatrix" title="emloop.hooks.SaveConfusionMatrix"><code class="xref py py-class docutils literal"><span class="pre">SaveConfusionMatrix</span></code></a> hook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>output_dir</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – output directory</li>
<li><strong>dataset</strong> (<a class="reference internal" href="emloop.datasets.html#emloop.datasets.BaseDataset" title="emloop.datasets.BaseDataset"><code class="xref py py-class docutils literal"><span class="pre">BaseDataset</span></code></a>) – dataset (needed to translate predictions to strings)</li>
<li><strong>labels_name</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – annotation variable name</li>
<li><strong>predictions_name</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – prediction variable name</li>
<li><strong>classes_names</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><code class="xref py py-data docutils literal"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Sequence" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>]]) – List of classes’ names</li>
<li><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><code class="xref py py-data docutils literal"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal"><span class="pre">Tuple</span></code>[<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>]]) – the size of the matplotlib figure</li>
<li><strong>figure_action</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – action to be taken with the plotted figure, one of <a class="reference internal" href="#emloop.hooks.SaveConfusionMatrix.FIGURE_ACTIONS" title="emloop.hooks.SaveConfusionMatrix.FIGURE_ACTIONS"><code class="xref py py-attr docutils literal"><span class="pre">FIGURE_ACTIONS</span></code></a></li>
<li><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a>) – False for plotting absolute values in confusion matrix, True for relative</li>
<li><strong>num_classes_method_name</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – <code class="docutils literal"><span class="pre">self._dataset</span></code> method name to get number of classes</li>
<li><strong>classes_names_method_name</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – <code class="docutils literal"><span class="pre">self._dataset</span></code> method name to get classes’ names
Parameter is ignored when <code class="docutils literal"><span class="pre">classes_names</span></code> is provided</li>
<li><strong>mask_name</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><code class="xref py py-data docutils literal"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>]) – the variable masking valid records (1 = valid, 0 = invalid)</li>
<li><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) – type of colorbar  # <a class="reference external" href="http://matplotlib.org/examples/color/colormaps_reference.html">http://matplotlib.org/examples/color/colormaps_reference.html</a></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#ValueError" title="(in Python v3.6)"><strong>ValueError</strong></a> – if the <code class="docutils literal"><span class="pre">figure_action</span></code> is not in <code class="docutils literal"><span class="pre">FIGURE_ACTIONS</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="exceptions">
<h2>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="#emloop.hooks.TrainingTerminated" title="emloop.hooks.TrainingTerminated"><code class="xref py py-exc docutils literal"><span class="pre">TrainingTerminated</span></code></a>:
Exception that is raised when a hook terminates the training.</li>
</ul>
<dl class="exception">
<dt id="emloop.hooks.TrainingTerminated">
<em class="property">exception </em><code class="descclassname">emloop.hooks.</code><code class="descname">TrainingTerminated</code><a class="reference internal" href="../_modules/emloop/types.html#TrainingTerminated"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emloop.hooks.TrainingTerminated" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception that is raised when a hook terminates the training.</p>
<p class="rubric">Inheritance</p>
<img src="../_images/inheritance-5d2a29d829a1304beee02bd9dc82c5b1db7d1229.png" alt="Inheritance diagram of TrainingTerminated" class="inheritance"/>
</dd></dl>

</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, Iterait a.s..<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.7.<br/>
    </p>
  </div>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-108491604-2"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-108491604-2');
</script>



  </body>
</html>